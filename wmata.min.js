var interval=3000;var elapsed_threshold=10;var l_cid=[];var test="OTNlOGRmMDQ2N2E0NGFmYmIxMTA0Y2VlYWFjZTBhNDM=";function clearTracks(){var a,b,f,d;while(l_cid.length>0){b=l_cid.pop();a=document.getElementById(b.CircuitId);if(a.classList.contains("st")){f="+"}else{if(a.classList.contains("rt")){f="\\"}else{if(a.classList.contains("lt")){f="/"}else{f="|"}}}a.innerHTML=f;a.classList.remove(b.LineCode);d=document.getElementById("cmt"+b.CircuitId);if(d!==null){d.innerHTML=""}}}function makeTimeString(a){if(a<60){return a+" s"}else{if(a<3600){return Math.round(a/60)+" m"}else{return Math.round(a/3600)+" h"}}}function processTrainData(d){var b,a=d.TrainPositions.length;var g,c;var f;clearTracks();for(b=0;b<a;++b){g=d.TrainPositions[b];e=document.getElementById(g.CircuitId);comment=document.getElementById("cmt"+g.CircuitId);if(e!==null){e.innerHTML=(g.ServiceType=="Normal")?g.CarCount:"?";e.title="train #"+g.TrainId+" dir="+g.DirectionNum+" dest="+g.DestinationStationCode;if(comment!==null){comment.innerHTML=(g.SecondsAtLocation>elapsed_threshold)?makeTimeString(g.SecondsAtLocation):" "}e.classList.add("visited");e.classList.add(g.LineCode);f={CircuitId:g.CircuitId,LineCode:g.LineCode};l_cid.push(f)}}}function getData(){var a={api_key:atob(test),};$.ajax({url:"https://api.wmata.com/TrainPositions/TrainPositions?contentType={contentType}&"+$.param(a),type:"GET",}).done(function(b){processTrainData(b)}).fail(function(){console.error("unable to access data from WMATA")})}document.addEventListener("keydown",function(a){if(a.keyCode==68){$("debug").hide()}});getData();var intervalID=setInterval(getData,interval);